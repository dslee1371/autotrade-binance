# .github/workflows/trigger-jenkins-on-tag.yml
name: Realese Application

on:
  push:
    # v1.2, v0.8 ì²˜ëŸ¼ 'v'ë¡œ ì‹œì‘í•˜ëŠ” ëª¨ë“  íƒœê·¸
    tags:
      - 'v*'

jobs:
  trigger-jenkins:
    runs-on: ubuntu-latest

    steps:
      - name: Trigger Jenkins build
        # í† í°ì€ GitHub Secrets ì— ë“±ë¡í–ˆë‹¤ê³  ê°€ì •
        env:
          JENKINS_TOKEN: ${{ secrets.JENKINS_TOKEN }}
        run: |
          # GITHUB_REF ì—ëŠ” refs/tags/v0.8 í˜•íƒœë¡œ ë“¤ì–´ì˜¤ë¯€ë¡œ, ì•ë¶€ë¶„ì„ ì˜ë¼ëƒ…ë‹ˆë‹¤.
          TAG="${GITHUB_REF#refs/tags/}"
          echo "ğŸ”” Triggering Jenkins build for tag ${TAG}"
          curl -X POST \
            "http://jenkins.apps.lab3.dslee.lab/job/autotrade-binance-app/buildWithParameters?token=${JENKINS_TOKEN}&UPDATE_GITOPS=true&TAG=${TAG}"
